import React, { useState } from 'react';\nimport { Button } from '../ui/Button';\nimport { \n  Square, Type, CheckSquare, Circle, Calendar, Mail, Phone,\n  FileText, List, Hash, DollarSign, Percent, Globe, MapPin,\n  User, Key, Eye, EyeOff, Lock, Unlock, Plus, Trash2\n} from 'lucide-react';\nimport { clsx } from 'clsx';\n\ntype FormFieldType = \n  | 'text' \n  | 'textarea' \n  | 'checkbox' \n  | 'radio' \n  | 'dropdown' \n  | 'date' \n  | 'email' \n  | 'phone' \n  | 'number' \n  | 'currency' \n  | 'percentage' \n  | 'url' \n  | 'password';\n\ninterface FormField {\n  id: string;\n  type: FormFieldType;\n  label: string;\n  placeholder?: string;\n  required: boolean;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  options?: string[]; // For dropdown/radio\n  validation?: {\n    minLength?: number;\n    maxLength?: number;\n    pattern?: string;\n  };\n  style: {\n    fontSize: number;\n    fontFamily: string;\n    color: string;\n    backgroundColor: string;\n    borderColor: string;\n    borderWidth: number;\n  };\n}\n\ninterface FormFieldEditorProps {\n  fields: FormField[];\n  selectedFieldId?: string;\n  onFieldAdd: (type: FormFieldType) => void;\n  onFieldUpdate: (id: string, updates: Partial<FormField>) => void;\n  onFieldDelete: (id: string) => void;\n  onFieldSelect: (id: string) => void;\n}\n\nexport default function FormFieldEditor({\n  fields,\n  selectedFieldId,\n  onFieldAdd,\n  onFieldUpdate,\n  onFieldDelete,\n  onFieldSelect\n}: FormFieldEditorProps) {\n  const [showFieldTypes, setShowFieldTypes] = useState(false);\n  const selectedField = fields.find(f => f.id === selectedFieldId);\n\n  const fieldTypes = [\n    { type: 'text' as FormFieldType, label: 'Text Field', icon: Type, color: 'text-blue-400' },\n    { type: 'textarea' as FormFieldType, label: 'Text Area', icon: FileText, color: 'text-green-400' },\n    { type: 'checkbox' as FormFieldType, label: 'Checkbox', icon: CheckSquare, color: 'text-purple-400' },\n    { type: 'radio' as FormFieldType, label: 'Radio Button', icon: Circle, color: 'text-pink-400' },\n    { type: 'dropdown' as FormFieldType, label: 'Dropdown', icon: List, color: 'text-yellow-400' },\n    { type: 'date' as FormFieldType, label: 'Date Picker', icon: Calendar, color: 'text-red-400' },\n    { type: 'email' as FormFieldType, label: 'Email', icon: Mail, color: 'text-cyan-400' },\n    { type: 'phone' as FormFieldType, label: 'Phone', icon: Phone, color: 'text-orange-400' },\n    { type: 'number' as FormFieldType, label: 'Number', icon: Hash, color: 'text-indigo-400' },\n    { type: 'currency' as FormFieldType, label: 'Currency', icon: DollarSign, color: 'text-green-400' },\n    { type: 'percentage' as FormFieldType, label: 'Percentage', icon: Percent, color: 'text-lime-400' },\n    { type: 'url' as FormFieldType, label: 'URL', icon: Globe, color: 'text-sky-400' },\n    { type: 'password' as FormFieldType, label: 'Password', icon: Key, color: 'text-gray-400' }\n  ];\n\n  const handleFieldUpdate = (property: keyof FormField, value: any) => {\n    if (selectedFieldId) {\n      onFieldUpdate(selectedFieldId, { [property]: value });\n    }\n  };\n\n  const handleStyleUpdate = (property: keyof FormField['style'], value: any) => {\n    if (selectedFieldId && selectedField) {\n      onFieldUpdate(selectedFieldId, {\n        style: {\n          ...selectedField.style,\n          [property]: value\n        }\n      });\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Field Types */}\n      <div className=\"bg-black/20 backdrop-blur-xl rounded-2xl border border-white/10 shadow-2xl p-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-white font-semibold flex items-center gap-2\">\n            <Square size={18} className=\"text-blue-400\" />\n            Form Fields\n          </h3>\n          <button\n            onClick={() => setShowFieldTypes(!showFieldTypes)}\n            className={clsx(\n              'p-2 rounded-lg transition-all duration-300',\n              showFieldTypes ? 'bg-blue-500 text-white' : 'bg-white/10 hover:bg-white/20 text-gray-300'\n            )}\n          >\n            <Plus size={16} />\n          </button>\n        </div>\n\n        {showFieldTypes && (\n          <div className=\"grid grid-cols-2 gap-2 mb-4\">\n            {fieldTypes.map(({ type, label, icon: Icon, color }) => (\n              <button\n                key={type}\n                onClick={() => {\n                  onFieldAdd(type);\n                  setShowFieldTypes(false);\n                }}\n                className=\"flex items-center gap-2 p-3 bg-white/5 hover:bg-white/10 rounded-lg transition-all duration-300 hover:scale-105\"\n              >\n                <Icon size={16} className={color} />\n                <span className=\"text-white text-sm font-medium\">{label}</span>\n              </button>\n            ))}\n          </div>\n        )}\n\n        {/* Field List */}\n        <div className=\"space-y-2 max-h-40 overflow-y-auto\">\n          {fields.map((field) => {\n            const fieldType = fieldTypes.find(ft => ft.type === field.type);\n            const Icon = fieldType?.icon || Square;\n            \n            return (\n              <div\n                key={field.id}\n                onClick={() => onFieldSelect(field.id)}\n                className={clsx(\n                  'group flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all duration-300',\n                  selectedFieldId === field.id\n                    ? 'bg-gradient-to-r from-blue-500/20 to-cyan-500/20 border border-blue-400/50'\n                    : 'bg-white/5 hover:bg-white/10 border border-white/10'\n                )}\n              >\n                <Icon size={16} className={fieldType?.color || 'text-gray-400'} />\n                <div className=\"flex-1\">\n                  <p className=\"text-white text-sm font-medium\">{field.label || `${field.type} field`}</p>\n                  <p className=\"text-gray-400 text-xs\">\n                    {field.width}Ã—{field.height} at ({field.x}, {field.y})\n                  </p>\n                </div>\n                <div className=\"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                  {field.required && (\n                    <div className=\"p-1 bg-red-500/20 rounded\">\n                      <span className=\"text-red-400 text-xs\">*</span>\n                    </div>\n                  )}\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      onFieldDelete(field.id);\n                    }}\n                    className=\"p-1 bg-red-500/20 hover:bg-red-500/30 rounded transition-colors\"\n                  >\n                    <Trash2 size={12} className=\"text-red-400\" />\n                  </button>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Field Properties */}\n      {selectedField && (\n        <div className=\"bg-black/20 backdrop-blur-xl rounded-2xl border border-white/10 shadow-2xl p-4\">\n          <h3 className=\"text-white font-semibold mb-4 flex items-center gap-2\">\n            <Type size={18} className=\"text-cyan-400\" />\n            Field Properties\n          </h3>\n          \n          <div className=\"space-y-4\">\n            {/* Basic Properties */}\n            <div>\n              <label className=\"text-sm text-gray-300 mb-2 block\">Label</label>\n              <input\n                type=\"text\"\n                value={selectedField.label}\n                onChange={(e) => handleFieldUpdate('label', e.target.value)}\n                className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500\"\n                placeholder=\"Field label\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"text-sm text-gray-300 mb-2 block\">Placeholder</label>\n              <input\n                type=\"text\"\n                value={selectedField.placeholder || ''}\n                onChange={(e) => handleFieldUpdate('placeholder', e.target.value)}\n                className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500\"\n                placeholder=\"Placeholder text\"\n              />\n            </div>\n            \n            <div className=\"flex items-center gap-2\">\n              <input\n                type=\"checkbox\"\n                id=\"required\"\n                checked={selectedField.required}\n                onChange={(e) => handleFieldUpdate('required', e.target.checked)}\n                className=\"w-4 h-4 bg-white/10 border border-white/20 rounded focus:ring-2 focus:ring-cyan-500\"\n              />\n              <label htmlFor=\"required\" className=\"text-sm text-gray-300\">\n                Required field\n              </label>\n            </div>\n            \n            {/* Position & Size */}\n            <div className=\"grid grid-cols-2 gap-3\">\n              <div>\n                <label className=\"text-sm text-gray-300 mb-1 block\">X Position</label>\n                <input\n                  type=\"number\"\n                  value={selectedField.x}\n                  onChange={(e) => handleFieldUpdate('x', parseInt(e.target.value))}\n                  className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm text-gray-300 mb-1 block\">Y Position</label>\n                <input\n                  type=\"number\"\n                  value={selectedField.y}\n                  onChange={(e) => handleFieldUpdate('y', parseInt(e.target.value))}\n                  className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500\"\n                />\n              </div>\n            </div>\n            \n            <div className=\"grid grid-cols-2 gap-3\">\n              <div>\n                <label className=\"text-sm text-gray-300 mb-1 block\">Width</label>\n                <input\n                  type=\"number\"\n                  value={selectedField.width}\n                  onChange={(e) => handleFieldUpdate('width', parseInt(e.target.value))}\n                  className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm text-gray-300 mb-1 block\">Height</label>\n                <input\n                  type=\"number\"\n                  value={selectedField.height}\n                  onChange={(e) => handleFieldUpdate('height', parseInt(e.target.value))}\n                  className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500\"\n                />\n              </div>\n            </div>\n            \n            {/* Options for dropdown/radio */}\n            {(selectedField.type === 'dropdown' || selectedField.type === 'radio') && (\n              <div>\n                <label className=\"text-sm text-gray-300 mb-2 block\">Options (one per line)</label>\n                <textarea\n                  value={(selectedField.options || []).join('\\n')}\n                  onChange={(e) => handleFieldUpdate('options', e.target.value.split('\\n').filter(o => o.trim()))}\n                  className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500\"\n                  rows={4}\n                  placeholder=\"Option 1\\nOption 2\\nOption 3\"\n                />\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n      \n      {/* Field Styling */}\n      {selectedField && (\n        <div className=\"bg-black/20 backdrop-blur-xl rounded-2xl border border-white/10 shadow-2xl p-4\">\n          <h3 className=\"text-white font-semibold mb-4 flex items-center gap-2\">\n            <Eye size={18} className=\"text-pink-400\" />\n            Appearance\n          </h3>\n          \n          <div className=\"space-y-4\">\n            {/* Font Size */}\n            <div>\n              <label className=\"text-sm text-gray-300 mb-2 block\">Font Size</label>\n              <div className=\"flex items-center gap-2\">\n                <input\n                  type=\"range\"\n                  min=\"8\"\n                  max=\"24\"\n                  value={selectedField.style.fontSize}\n                  onChange={(e) => handleStyleUpdate('fontSize', parseInt(e.target.value))}\n                  className=\"flex-1 h-2 bg-white/20 rounded-lg appearance-none cursor-pointer\"\n                />\n                <span className=\"text-white font-medium min-w-[40px] text-center\">\n                  {selectedField.style.fontSize}px\n                </span>\n              </div>\n            </div>\n            \n            {/* Colors */}\n            <div className=\"grid grid-cols-3 gap-3\">\n              <div>\n                <label className=\"text-sm text-gray-300 mb-1 block\">Text</label>\n                <input\n                  type=\"color\"\n                  value={selectedField.style.color}\n                  onChange={(e) => handleStyleUpdate('color', e.target.value)}\n                  className=\"w-full h-10 bg-white/10 border border-white/20 rounded-lg cursor-pointer\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm text-gray-300 mb-1 block\">Background</label>\n                <input\n                  type=\"color\"\n                  value={selectedField.style.backgroundColor}\n                  onChange={(e) => handleStyleUpdate('backgroundColor', e.target.value)}\n                  className=\"w-full h-10 bg-white/10 border border-white/20 rounded-lg cursor-pointer\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm text-gray-300 mb-1 block\">Border</label>\n                <input\n                  type=\"color\"\n                  value={selectedField.style.borderColor}\n                  onChange={(e) => handleStyleUpdate('borderColor', e.target.value)}\n                  className=\"w-full h-10 bg-white/10 border border-white/20 rounded-lg cursor-pointer\"\n                />\n              </div>\n            </div>\n            \n            {/* Border Width */}\n            <div>\n              <label className=\"text-sm text-gray-300 mb-2 block\">Border Width</label>\n              <div className=\"flex items-center gap-2\">\n                <input\n                  type=\"range\"\n                  min=\"0\"\n                  max=\"5\"\n                  value={selectedField.style.borderWidth}\n                  onChange={(e) => handleStyleUpdate('borderWidth', parseInt(e.target.value))}\n                  className=\"flex-1 h-2 bg-white/20 rounded-lg appearance-none cursor-pointer\"\n                />\n                <span className=\"text-white font-medium min-w-[30px] text-center\">\n                  {selectedField.style.borderWidth}px\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Field Validation */}\n      {selectedField && ['text', 'textarea', 'email', 'url'].includes(selectedField.type) && (\n        <div className=\"bg-black/20 backdrop-blur-xl rounded-2xl border border-white/10 shadow-2xl p-4\">\n          <h3 className=\"text-white font-semibold mb-4 flex items-center gap-2\">\n            <Lock size={18} className=\"text-orange-400\" />\n            Validation\n          </h3>\n          \n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-3\">\n              <div>\n                <label className=\"text-sm text-gray-300 mb-1 block\">Min Length</label>\n                <input\n                  type=\"number\"\n                  value={selectedField.validation?.minLength || ''}\n                  onChange={(e) => handleFieldUpdate('validation', {\n                    ...selectedField.validation,\n                    minLength: e.target.value ? parseInt(e.target.value) : undefined\n                  })}\n                  className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm text-gray-300 mb-1 block\">Max Length</label>\n                <input\n                  type=\"number\"\n                  value={selectedField.validation?.maxLength || ''}\n                  onChange={(e) => handleFieldUpdate('validation', {\n                    ...selectedField.validation,\n                    maxLength: e.target.value ? parseInt(e.target.value) : undefined\n                  })}\n                  className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500\"\n                />\n              </div>\n            </div>\n            \n            <div>\n              <label className=\"text-sm text-gray-300 mb-2 block\">Regex Pattern</label>\n              <input\n                type=\"text\"\n                value={selectedField.validation?.pattern || ''}\n                onChange={(e) => handleFieldUpdate('validation', {\n                  ...selectedField.validation,\n                  pattern: e.target.value || undefined\n                })}\n                className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500\"\n                placeholder=\"e.g., ^[A-Za-z0-9]+$\"\n              />\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}